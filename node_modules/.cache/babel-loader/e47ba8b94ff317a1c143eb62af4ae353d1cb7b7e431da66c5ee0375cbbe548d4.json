{"ast":null,"code":"import React,{useState}from'react';import BonusBridgeExplanation from'./BonusBridgeExplanation';import'./FinalScoreAnalysis.css';/**\r\n * Component to display final score analysis after Bonus Bridge adjustments\r\n * Redesigned for mobile with tabbed sections and improved UI\r\n */import{jsxs as _jsxs,jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";const FinalScoreAnalysis=_ref=>{let{analysisData,currentDeal,onSave,onEdit,setGameState,scores}=_ref;// State for active tab\nconst[activeTab,setActiveTab]=useState('calculation');// State for showing explanation\nconst[showExplanation,setShowExplanation]=useState(false);// State for showing scores so far\nconst[showScoresSoFar,setShowScoresSoFar]=useState(false);// State for end game confirmation\nconst[showEndGameConfirm,setShowEndGameConfirm]=useState(false);// Determine if the contract was made\nconst madeContract=currentDeal.result>=0;// Extract information for display\nconst{totalHCP,declarerHCPPercentage,defenderHCPPercentage,hcpAdvantage,advantageSide,expectedHCP,singletons,voids,longSuits,distributionPoints,contractExpectedTricks,handExpectedTricks,nsPoints,ewPoints}=analysisData;// Format contract for display\nconst formatContract=()=>{if(!currentDeal||!currentDeal.contract)return\"\";// Parse contract components\nconst contractMatch=currentDeal.contract.match(/(\\d)([♣♦♥♠]|NT)\\s+([NESW])(X{0,2})/);if(!contractMatch)return currentDeal.contract;const level=contractMatch[1];const suit=contractMatch[2];const declarer=contractMatch[3];const doubled=contractMatch[4]||\"\";// Format doubled status\nlet doubledText=\"\";if(doubled===\"X\"){doubledText=\" Doubled\";}else if(doubled===\"XX\"){doubledText=\" Redoubled\";}// Get full declarer direction\nlet declarerFull=\"\";switch(declarer){case'N':declarerFull=\"North\";break;case'E':declarerFull=\"East\";break;case'S':declarerFull=\"South\";break;case'W':declarerFull=\"West\";break;default:declarerFull=declarer;}return`${level}${suit} By ${declarerFull}${doubledText}`;};// Get contract category description\nconst getContractCategory=()=>{if(!madeContract){// For defeated contracts\nconst undertricks=Math.abs(currentDeal.result);// Check if it's a game contract\nconst contractMatch=currentDeal.contract.match(/(\\d)([♣♦♥♠]|NT)\\s+([NESW])(X{0,2})/);if(!contractMatch)return\"Defeated Contract\";const level=parseInt(contractMatch[1]);const suit=contractMatch[2];const isGameContract=level===3&&suit==='NT'||level===4&&(suit==='♥'||suit==='♠')||level===5&&(suit==='♣'||suit==='♦')||level>=6;if(level>=6){return`Failed Slam Attempt (Down ${undertricks})`;}else if(isGameContract){return`Failed Game Contract (Down ${undertricks})`;}else{return`Failed Part Score (Down ${undertricks})`;}}else{// For made contracts\nconst overtricks=currentDeal.result;// Check contract type\nconst contractMatch=currentDeal.contract.match(/(\\d)([♣♦♥♠]|NT)\\s+([NESW])(X{0,2})/);if(!contractMatch)return\"Made Contract\";const level=parseInt(contractMatch[1]);const suit=contractMatch[2];const doubled=contractMatch[4]||\"\";const isGameContract=level===3&&suit==='NT'||level===4&&(suit==='♥'||suit==='♠')||level===5&&(suit==='♣'||suit==='♦')||level>=6;// Check HCP relationship to expected\nconst hcpDifference=totalHCP-expectedHCP;const hcpStatus=hcpDifference>=2?\"Strong\":hcpDifference<=-2?\"Weak\":\"Balanced\";// Include doubled status in category\nlet doubledStatus=\"\";if(doubled===\"X\"){doubledStatus=\" Doubled\";}else if(doubled===\"XX\"){doubledStatus=\" Redoubled\";}if(level>=6){return`Made Slam${doubledStatus}${overtricks>0?` (+${overtricks})`:''}`;}else if(isGameContract){return`Made Game${doubledStatus} with ${hcpStatus} Hand${overtricks>0?` (+${overtricks})`:''}`;}else{return`Made Part Score${doubledStatus}${overtricks>0?` (+${overtricks})`:''}`;}}};// Various handlers\nconst handleShowExplanation=()=>setShowExplanation(true);const handleHideExplanation=()=>setShowExplanation(false);const toggleScoresSoFar=()=>setShowScoresSoFar(!showScoresSoFar);const handleShowEndGameConfirm=()=>setShowEndGameConfirm(true);const handleHideEndGameConfirm=()=>setShowEndGameConfirm(false);// End the game and show final results\nconst handleEndGame=()=>{// First save the current deal's scores\nhandleSave();// Then set the game as ended to trigger GameScoreSheet display\nsetTimeout(()=>{setGameState(prevState=>({...prevState,gameEnded:true}));},100);};// Change active tab\nconst handleTabChange=tab=>{setActiveTab(tab);};// Handle save and continue\nconst handleSave=()=>{// Calculate final scores to send to parent\nconst finalScore={nsPoints:nsPoints||0,ewPoints:ewPoints||0,currentDealWithBonusScores:{...currentDeal,bonusNsPoints:nsPoints||0,bonusEwPoints:ewPoints||0}};onSave(finalScore);};// Get final score from calculation steps\nconst getFinalScore=()=>{if(madeContract){// Determine which side gets the score\nconst contractMatch=currentDeal.contract.match(/(\\d)([♣♦♥♠]|NT)\\s+([NESW])(X{0,2})/);if(!contractMatch)return{declarerPoints:0,defenderPoints:0};const declarer=contractMatch[3];const isNS=declarer==='N'||declarer==='S';if(isNS){return{declarerTeam:\"North-South\",defenderTeam:\"East-West\",declarerPoints:nsPoints,defenderPoints:ewPoints};}else{return{declarerTeam:\"East-West\",defenderTeam:\"North-South\",declarerPoints:ewPoints,defenderPoints:nsPoints};}}else{// For defeated contracts - defenders get the points\nconst contractMatch=currentDeal.contract.match(/(\\d)([♣♦♥♠]|NT)\\s+([NESW])(X{0,2})/);if(!contractMatch)return{defenderPoints:0,declarerPoints:0};const declarer=contractMatch[3];const isNS=declarer==='N'||declarer==='S';if(isNS){// NS is declarer, EW is defender\nreturn{declarerTeam:\"North-South\",defenderTeam:\"East-West\",declarerPoints:nsPoints,defenderPoints:ewPoints};}else{// EW is declarer, NS is defender\nreturn{declarerTeam:\"East-West\",defenderTeam:\"North-South\",declarerPoints:ewPoints,defenderPoints:nsPoints};}}};// Get calculation steps for display\nconst getCalculationSteps=()=>{if(madeContract){return[{label:\"1. Raw Score / 20:\",value:`${(analysisData.rawScore||0).toFixed(1)} points`},{label:\"2. HCP Adjustment:\",value:`${(analysisData.hcpAdjustment||0).toFixed(2)} points`},{label:\"3. After HCP Adjustment:\",value:`${(analysisData.afterHcpAdjustment||0).toFixed(1)} points`},{label:\"4. Performance Variance:\",value:`${analysisData.performanceVariance||0} tricks`},{label:\"5. After Performance Assessment:\",value:`${(analysisData.afterPerformanceAssessment||0).toFixed(1)} points`},{label:\"6. Contract Type Adjustment:\",value:`${(analysisData.contractTypeAdjustment||0).toFixed(1)} ${analysisData.contractTypeDescription||''}`},{label:\"7. After Contract Adjustments:\",value:`${(analysisData.afterContractAdjustments||0).toFixed(1)} points`},{label:\"8. Distribution Adjustment:\",value:`${(analysisData.distributionAdjustment||0).toFixed(1)} points`},{label:\"9. Defender Reward:\",value:`${(analysisData.defenderReward||0).toFixed(1)} points`}];}else{// For defeated contracts\nreturn[{label:\"1. Base Penalty:\",value:`${(analysisData.basePenalty||0).toFixed(1)} points`},{label:\"2. Contract Level Penalties:\",value:`${(analysisData.levelPenalties||0).toFixed(1)} points`},{label:\"3. Performance Bonus:\",value:`${(analysisData.performanceBonus||0).toFixed(1)} points`},{label:\"4. Declarer Consolation:\",value:`${(analysisData.consolationPoints||0).toFixed(1)} points`}];}};// Get final score for display\nconst finalScore=getFinalScore();// Get scores so far for display - including the current deal's scores\nconst getScoresSoFar=()=>{// Get the running totals from scores prop\nconst baseTotals={nsTotal:(scores===null||scores===void 0?void 0:scores.nsTotal)||0,ewTotal:(scores===null||scores===void 0?void 0:scores.ewTotal)||0,bonusNsTotal:(scores===null||scores===void 0?void 0:scores.bonusNsTotal)||0,bonusEwTotal:(scores===null||scores===void 0?void 0:scores.bonusEwTotal)||0};// Add the current deal's points to provide the most updated view\nreturn{nsTotal:baseTotals.nsTotal,ewTotal:baseTotals.ewTotal,bonusNsTotal:baseTotals.bonusNsTotal+(nsPoints||0),bonusEwTotal:baseTotals.bonusEwTotal+(ewPoints||0)};};const scoresSoFar=getScoresSoFar();// Popup styles\nconst popupStyles={overlay:{position:'fixed',top:0,left:0,right:0,bottom:0,backgroundColor:'rgba(0, 0, 0, 0.7)',zIndex:1000,display:'flex',justifyContent:'center',alignItems:'center'},container:{backgroundColor:'#fff',borderRadius:'8px',padding:'20px',width:'80%',maxWidth:'320px',boxShadow:'0 4px 8px rgba(0, 0, 0, 0.2)'},title:{fontSize:'18px',fontWeight:'bold',marginBottom:'15px',textAlign:'center',color:'#1e5c8b'},message:{marginBottom:'15px',lineHeight:'1.4',textAlign:'center',fontSize:'15px'},buttonContainer:{display:'flex',justifyContent:'space-around'},button:{padding:'8px 15px',borderRadius:'5px',border:'none',color:'#fff',fontWeight:'bold',cursor:'pointer',fontSize:'14px'},cancelButton:{backgroundColor:'#1e5c8b'},confirmButton:{backgroundColor:'#3c8c5c'}};return/*#__PURE__*/_jsxs(\"div\",{className:\"final-score-analysis\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"analysis-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"title-container\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Final Score Analysis - Deal #\",currentDeal.dealNumber]}),/*#__PURE__*/_jsx(\"p\",{children:\"Bonus Bridge Score Calculation\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"scores-btn\",onClick:toggleScoresSoFar,children:\"Scores\"}),/*#__PURE__*/_jsx(\"button\",{className:\"info-btn\",onClick:handleShowExplanation,children:\"?\"})]})]}),showScoresSoFar&&/*#__PURE__*/_jsx(\"div\",{className:\"scores-popup\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"scores-popup-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Scores So Far\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"scores-table\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"scores-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"team-col\",children:\"Team\"}),/*#__PURE__*/_jsx(\"div\",{className:\"party-col\",children:\"Party Bridge\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bonus-col\",children:\"Bonus Bridge\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"scores-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"team-col\",children:\"North-South\"}),/*#__PURE__*/_jsx(\"div\",{className:\"party-col\",children:scoresSoFar.nsTotal}),/*#__PURE__*/_jsx(\"div\",{className:\"bonus-col\",children:scoresSoFar.bonusNsTotal})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"scores-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"team-col\",children:\"East-West\"}),/*#__PURE__*/_jsx(\"div\",{className:\"party-col\",children:scoresSoFar.ewTotal}),/*#__PURE__*/_jsx(\"div\",{className:\"bonus-col\",children:scoresSoFar.bonusEwTotal})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"close-scores-btn\",onClick:toggleScoresSoFar,children:\"Close\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"contract-category\",children:/*#__PURE__*/_jsx(\"h2\",{children:getContractCategory()})}),/*#__PURE__*/_jsxs(\"div\",{className:\"contract-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Contract: \",formatContract(),\" \",madeContract?'Made':'Down',\" \",currentDeal.result!==0?Math.abs(currentDeal.result):'exactly']}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Raw score: \",currentDeal.rawScore,\" points\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"analysis-tabs\",children:[/*#__PURE__*/_jsx(\"button\",{className:`tab-btn ${activeTab==='summary'?'active':''}`,onClick:()=>handleTabChange('summary'),children:\"Summary\"}),/*#__PURE__*/_jsx(\"button\",{className:`tab-btn ${activeTab==='hand'?'active':''}`,onClick:()=>handleTabChange('hand'),children:\"Hand Analysis\"}),/*#__PURE__*/_jsx(\"button\",{className:`tab-btn ${activeTab==='calculation'?'active':''}`,onClick:()=>handleTabChange('calculation'),children:\"Calculation\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"tab-content\",children:[activeTab==='summary'&&/*#__PURE__*/_jsx(\"div\",{className:\"summary-tab\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"final-scores\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Final Bonus Bridge Score\"}),/*#__PURE__*/_jsx(\"div\",{className:\"score-box\",children:!madeContract?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"score-row\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"score-label\",children:[finalScore.defenderTeam,\" (Defender):\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"score-value\",children:[finalScore.defenderPoints,\" points\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"score-row\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"score-label\",children:[finalScore.declarerTeam,\" (Declarer):\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"score-value\",children:[finalScore.declarerPoints,\" points\"]})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"score-row\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"score-label\",children:[finalScore.declarerTeam,\" (Declarer):\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"score-value\",children:[finalScore.declarerPoints,\" points\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"score-row\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"score-label\",children:[finalScore.defenderTeam,\" (Defender):\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"score-value\",children:[finalScore.defenderPoints,\" points\"]})]})]})}),/*#__PURE__*/_jsx(\"p\",{className:\"score-explanation\",children:madeContract?`The contract was made${currentDeal.result>0?' with '+currentDeal.result+' overtrick'+(currentDeal.result>1?'s':''):' exactly'}.`:`The contract was defeated by ${Math.abs(currentDeal.result)} trick${Math.abs(currentDeal.result)>1?'s':''}.`})]})}),activeTab==='hand'&&/*#__PURE__*/_jsxs(\"div\",{className:\"hand-tab\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Hand Analysis\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"analysis-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-label\",children:\"Combined HCP (Declarer + Dummy):\"}),/*#__PURE__*/_jsx(\"span\",{className:\"detail-value\",children:totalHCP})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-label\",children:\"Declarer HCP Percentage:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"detail-value\",children:[declarerHCPPercentage,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-label\",children:\"Defender HCP Percentage:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"detail-value\",children:[defenderHCPPercentage,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-label\",children:\"HCP Advantage:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"detail-value\",children:[hcpAdvantage,\"% to \",advantageSide]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-label\",children:\"Number of Singletons:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"detail-value\",children:singletons})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-label\",children:\"Number of Voids:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"detail-value\",children:voids})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-label\",children:\"Number of Long Suits (6+ cards):\"}),/*#__PURE__*/_jsx(\"span\",{className:\"detail-value\",children:longSuits})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-label\",children:\"Distribution Points:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"detail-value\",children:distributionPoints})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-label\",children:\"Expected HCP for Contract:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"detail-value\",children:expectedHCP})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-label\",children:\"Contract Expected Tricks:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"detail-value\",children:contractExpectedTricks})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"detail-label\",children:\"Hand Expected Tricks:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"detail-value\",children:handExpectedTricks})]})]})]}),activeTab==='calculation'&&/*#__PURE__*/_jsxs(\"div\",{className:\"calculation-tab\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Calculation Steps (\",madeContract?'Made Contract':'Defeated Contract',\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"calculation-steps\",children:getCalculationSteps().map((step,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"calc-step\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"step-label\",children:step.label}),/*#__PURE__*/_jsx(\"span\",{className:\"step-value\",children:step.value})]},index))}),/*#__PURE__*/_jsxs(\"div\",{className:\"final-calculation\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Final Result\"}),!madeContract?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"calc-step\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"step-label\",children:[finalScore.defenderTeam,\" Points:\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"step-value\",children:finalScore.defenderPoints})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"calc-step\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"step-label\",children:[finalScore.declarerTeam,\" Points:\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"step-value\",children:finalScore.declarerPoints})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"calc-step\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"step-label\",children:[finalScore.declarerTeam,\" Points:\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"step-value\",children:finalScore.declarerPoints})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"calc-step\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"step-label\",children:[finalScore.defenderTeam,\" Points:\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"step-value\",children:finalScore.defenderPoints})]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-action-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"edit-analysis-btn\",onClick:onEdit,children:\"Edit Analysis\"}),/*#__PURE__*/_jsx(\"button\",{className:\"save-continue-btn\",onClick:handleSave,children:\"Save & Continue\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"end-game-row\",children:/*#__PURE__*/_jsx(\"button\",{className:\"end-game-btn\",onClick:handleShowEndGameConfirm,children:\"End Game & View Results\"})}),showExplanation&&/*#__PURE__*/_jsx(BonusBridgeExplanation,{onClose:handleHideExplanation}),showEndGameConfirm&&/*#__PURE__*/_jsx(\"div\",{style:popupStyles.overlay,children:/*#__PURE__*/_jsxs(\"div\",{style:popupStyles.container,children:[/*#__PURE__*/_jsx(\"h2\",{style:popupStyles.title,children:\"End Current Game?\"}),/*#__PURE__*/_jsx(\"p\",{style:popupStyles.message,children:\"Are you sure you want to end the current game? This will save the current deal and show the final game results.\"}),/*#__PURE__*/_jsxs(\"div\",{style:popupStyles.buttonContainer,children:[/*#__PURE__*/_jsx(\"button\",{style:{...popupStyles.button,...popupStyles.cancelButton},onClick:handleHideEndGameConfirm,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{style:{...popupStyles.button,...popupStyles.confirmButton},onClick:handleEndGame,children:\"End Game\"})]})]})})]});};export default FinalScoreAnalysis;","map":{"version":3,"names":["React","useState","BonusBridgeExplanation","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","FinalScoreAnalysis","_ref","analysisData","currentDeal","onSave","onEdit","setGameState","scores","activeTab","setActiveTab","showExplanation","setShowExplanation","showScoresSoFar","setShowScoresSoFar","showEndGameConfirm","setShowEndGameConfirm","madeContract","result","totalHCP","declarerHCPPercentage","defenderHCPPercentage","hcpAdvantage","advantageSide","expectedHCP","singletons","voids","longSuits","distributionPoints","contractExpectedTricks","handExpectedTricks","nsPoints","ewPoints","formatContract","contract","contractMatch","match","level","suit","declarer","doubled","doubledText","declarerFull","getContractCategory","undertricks","Math","abs","parseInt","isGameContract","overtricks","hcpDifference","hcpStatus","doubledStatus","handleShowExplanation","handleHideExplanation","toggleScoresSoFar","handleShowEndGameConfirm","handleHideEndGameConfirm","handleEndGame","handleSave","setTimeout","prevState","gameEnded","handleTabChange","tab","finalScore","currentDealWithBonusScores","bonusNsPoints","bonusEwPoints","getFinalScore","declarerPoints","defenderPoints","isNS","declarerTeam","defenderTeam","getCalculationSteps","label","value","rawScore","toFixed","hcpAdjustment","afterHcpAdjustment","performanceVariance","afterPerformanceAssessment","contractTypeAdjustment","contractTypeDescription","afterContractAdjustments","distributionAdjustment","defenderReward","basePenalty","levelPenalties","performanceBonus","consolationPoints","getScoresSoFar","baseTotals","nsTotal","ewTotal","bonusNsTotal","bonusEwTotal","scoresSoFar","popupStyles","overlay","position","top","left","right","bottom","backgroundColor","zIndex","display","justifyContent","alignItems","container","borderRadius","padding","width","maxWidth","boxShadow","title","fontSize","fontWeight","marginBottom","textAlign","color","message","lineHeight","buttonContainer","button","border","cursor","cancelButton","confirmButton","className","children","dealNumber","onClick","map","step","index","onClose","style"],"sources":["C:/Users/mikec/MikesBridge/bonusbridge/src/components/FinalScoreAnalysis.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport BonusBridgeExplanation from './BonusBridgeExplanation';\r\nimport './FinalScoreAnalysis.css';\r\n\r\n/**\r\n * Component to display final score analysis after Bonus Bridge adjustments\r\n * Redesigned for mobile with tabbed sections and improved UI\r\n */\r\nconst FinalScoreAnalysis = ({ \r\n  analysisData, \r\n  currentDeal, \r\n  onSave, \r\n  onEdit,\r\n  setGameState,\r\n  scores\r\n}) => {\r\n  // State for active tab\r\n  const [activeTab, setActiveTab] = useState('calculation');\r\n  // State for showing explanation\r\n  const [showExplanation, setShowExplanation] = useState(false);\r\n  // State for showing scores so far\r\n  const [showScoresSoFar, setShowScoresSoFar] = useState(false);\r\n  // State for end game confirmation\r\n  const [showEndGameConfirm, setShowEndGameConfirm] = useState(false);\r\n  \r\n  // Determine if the contract was made\r\n  const madeContract = currentDeal.result >= 0;\r\n  \r\n  // Extract information for display\r\n  const {\r\n    totalHCP,\r\n    declarerHCPPercentage,\r\n    defenderHCPPercentage,\r\n    hcpAdvantage,\r\n    advantageSide,\r\n    expectedHCP,\r\n    singletons,\r\n    voids,\r\n    longSuits,\r\n    distributionPoints,\r\n    contractExpectedTricks,\r\n    handExpectedTricks,\r\n    nsPoints,\r\n    ewPoints\r\n  } = analysisData;\r\n  \r\n  // Format contract for display\r\n  const formatContract = () => {\r\n    if (!currentDeal || !currentDeal.contract) return \"\";\r\n    \r\n    // Parse contract components\r\n    const contractMatch = currentDeal.contract.match(/(\\d)([♣♦♥♠]|NT)\\s+([NESW])(X{0,2})/);\r\n    if (!contractMatch) return currentDeal.contract;\r\n    \r\n    const level = contractMatch[1];\r\n    const suit = contractMatch[2];\r\n    const declarer = contractMatch[3];\r\n    const doubled = contractMatch[4] || \"\";\r\n    \r\n    // Format doubled status\r\n    let doubledText = \"\";\r\n    if (doubled === \"X\") {\r\n      doubledText = \" Doubled\";\r\n    } else if (doubled === \"XX\") {\r\n      doubledText = \" Redoubled\";\r\n    }\r\n    \r\n    // Get full declarer direction\r\n    let declarerFull = \"\";\r\n    switch (declarer) {\r\n      case 'N': declarerFull = \"North\"; break;\r\n      case 'E': declarerFull = \"East\"; break;\r\n      case 'S': declarerFull = \"South\"; break;\r\n      case 'W': declarerFull = \"West\"; break;\r\n      default: declarerFull = declarer;\r\n    }\r\n    \r\n    return `${level}${suit} By ${declarerFull}${doubledText}`;\r\n  };\r\n  \r\n  // Get contract category description\r\n  const getContractCategory = () => {\r\n    if (!madeContract) {\r\n      // For defeated contracts\r\n      const undertricks = Math.abs(currentDeal.result);\r\n      \r\n      // Check if it's a game contract\r\n      const contractMatch = currentDeal.contract.match(/(\\d)([♣♦♥♠]|NT)\\s+([NESW])(X{0,2})/);\r\n      if (!contractMatch) return \"Defeated Contract\";\r\n      \r\n      const level = parseInt(contractMatch[1]);\r\n      const suit = contractMatch[2];\r\n      \r\n      const isGameContract = \r\n        (level === 3 && suit === 'NT') ||\r\n        (level === 4 && (suit === '♥' || suit === '♠')) ||\r\n        (level === 5 && (suit === '♣' || suit === '♦')) ||\r\n        level >= 6;\r\n      \r\n      if (level >= 6) {\r\n        return `Failed Slam Attempt (Down ${undertricks})`;\r\n      } else if (isGameContract) {\r\n        return `Failed Game Contract (Down ${undertricks})`;\r\n      } else {\r\n        return `Failed Part Score (Down ${undertricks})`;\r\n      }\r\n    } else {\r\n      // For made contracts\r\n      const overtricks = currentDeal.result;\r\n      \r\n      // Check contract type\r\n      const contractMatch = currentDeal.contract.match(/(\\d)([♣♦♥♠]|NT)\\s+([NESW])(X{0,2})/);\r\n      if (!contractMatch) return \"Made Contract\";\r\n      \r\n      const level = parseInt(contractMatch[1]);\r\n      const suit = contractMatch[2];\r\n      const doubled = contractMatch[4] || \"\";\r\n      \r\n      const isGameContract = \r\n        (level === 3 && suit === 'NT') ||\r\n        (level === 4 && (suit === '♥' || suit === '♠')) ||\r\n        (level === 5 && (suit === '♣' || suit === '♦')) ||\r\n        level >= 6;\r\n      \r\n      // Check HCP relationship to expected\r\n      const hcpDifference = totalHCP - expectedHCP;\r\n      const hcpStatus = hcpDifference >= 2 ? \"Strong\" : (hcpDifference <= -2 ? \"Weak\" : \"Balanced\");\r\n      \r\n      // Include doubled status in category\r\n      let doubledStatus = \"\";\r\n      if (doubled === \"X\") {\r\n        doubledStatus = \" Doubled\";\r\n      } else if (doubled === \"XX\") {\r\n        doubledStatus = \" Redoubled\";\r\n      }\r\n      \r\n      if (level >= 6) {\r\n        return `Made Slam${doubledStatus}${overtricks > 0 ? ` (+${overtricks})` : ''}`;\r\n      } else if (isGameContract) {\r\n        return `Made Game${doubledStatus} with ${hcpStatus} Hand${overtricks > 0 ? ` (+${overtricks})` : ''}`;\r\n      } else {\r\n        return `Made Part Score${doubledStatus}${overtricks > 0 ? ` (+${overtricks})` : ''}`;\r\n      }\r\n    }\r\n  };\r\n  \r\n  // Various handlers\r\n  const handleShowExplanation = () => setShowExplanation(true);\r\n  const handleHideExplanation = () => setShowExplanation(false);\r\n  const toggleScoresSoFar = () => setShowScoresSoFar(!showScoresSoFar);\r\n  const handleShowEndGameConfirm = () => setShowEndGameConfirm(true);\r\n  const handleHideEndGameConfirm = () => setShowEndGameConfirm(false);\r\n  \r\n  // End the game and show final results\r\n  const handleEndGame = () => {\r\n    // First save the current deal's scores\r\n    handleSave();\r\n    \r\n    // Then set the game as ended to trigger GameScoreSheet display\r\n    setTimeout(() => {\r\n      setGameState(prevState => ({\r\n        ...prevState,\r\n        gameEnded: true\r\n      }));\r\n    }, 100);\r\n  };\r\n  \r\n  // Change active tab\r\n  const handleTabChange = (tab) => {\r\n    setActiveTab(tab);\r\n  };\r\n  \r\n  // Handle save and continue\r\n  const handleSave = () => {\r\n    // Calculate final scores to send to parent\r\n    const finalScore = {\r\n      nsPoints: nsPoints || 0,\r\n      ewPoints: ewPoints || 0,\r\n      currentDealWithBonusScores: {\r\n        ...currentDeal,\r\n        bonusNsPoints: nsPoints || 0,\r\n        bonusEwPoints: ewPoints || 0\r\n      }\r\n    };\r\n    \r\n    onSave(finalScore);\r\n  };\r\n  \r\n  // Get final score from calculation steps\r\n  const getFinalScore = () => {\r\n    if (madeContract) {\r\n      // Determine which side gets the score\r\n      const contractMatch = currentDeal.contract.match(/(\\d)([♣♦♥♠]|NT)\\s+([NESW])(X{0,2})/);\r\n      if (!contractMatch) return { declarerPoints: 0, defenderPoints: 0 };\r\n      \r\n      const declarer = contractMatch[3];\r\n      const isNS = declarer === 'N' || declarer === 'S';\r\n      \r\n      if (isNS) {\r\n        return {\r\n          declarerTeam: \"North-South\",\r\n          defenderTeam: \"East-West\",\r\n          declarerPoints: nsPoints,\r\n          defenderPoints: ewPoints\r\n        };\r\n      } else {\r\n        return {\r\n          declarerTeam: \"East-West\",\r\n          defenderTeam: \"North-South\",\r\n          declarerPoints: ewPoints,\r\n          defenderPoints: nsPoints\r\n        };\r\n      }\r\n    } else {\r\n      // For defeated contracts - defenders get the points\r\n      const contractMatch = currentDeal.contract.match(/(\\d)([♣♦♥♠]|NT)\\s+([NESW])(X{0,2})/);\r\n      if (!contractMatch) return { defenderPoints: 0, declarerPoints: 0 };\r\n      \r\n      const declarer = contractMatch[3];\r\n      const isNS = declarer === 'N' || declarer === 'S';\r\n      \r\n      if (isNS) {\r\n        // NS is declarer, EW is defender\r\n        return {\r\n          declarerTeam: \"North-South\",\r\n          defenderTeam: \"East-West\",\r\n          declarerPoints: nsPoints,\r\n          defenderPoints: ewPoints\r\n        };\r\n      } else {\r\n        // EW is declarer, NS is defender\r\n        return {\r\n          declarerTeam: \"East-West\",\r\n          defenderTeam: \"North-South\",\r\n          declarerPoints: ewPoints,\r\n          defenderPoints: nsPoints\r\n        };\r\n      }\r\n    }\r\n  };\r\n  \r\n  // Get calculation steps for display\r\n  const getCalculationSteps = () => {\r\n    if (madeContract) {\r\n      return [\r\n        { \r\n          label: \"1. Raw Score / 20:\", \r\n          value: `${(analysisData.rawScore || 0).toFixed(1)} points` \r\n        },\r\n        { \r\n          label: \"2. HCP Adjustment:\", \r\n          value: `${(analysisData.hcpAdjustment || 0).toFixed(2)} points` \r\n        },\r\n        { \r\n          label: \"3. After HCP Adjustment:\", \r\n          value: `${(analysisData.afterHcpAdjustment || 0).toFixed(1)} points` \r\n        },\r\n        { \r\n          label: \"4. Performance Variance:\", \r\n          value: `${analysisData.performanceVariance || 0} tricks` \r\n        },\r\n        { \r\n          label: \"5. After Performance Assessment:\", \r\n          value: `${(analysisData.afterPerformanceAssessment || 0).toFixed(1)} points` \r\n        },\r\n        { \r\n          label: \"6. Contract Type Adjustment:\", \r\n          value: `${(analysisData.contractTypeAdjustment || 0).toFixed(1)} ${analysisData.contractTypeDescription || ''}` \r\n        },\r\n        { \r\n          label: \"7. After Contract Adjustments:\", \r\n          value: `${(analysisData.afterContractAdjustments || 0).toFixed(1)} points` \r\n        },\r\n        { \r\n          label: \"8. Distribution Adjustment:\", \r\n          value: `${(analysisData.distributionAdjustment || 0).toFixed(1)} points` \r\n        },\r\n        { \r\n          label: \"9. Defender Reward:\", \r\n          value: `${(analysisData.defenderReward || 0).toFixed(1)} points` \r\n        }\r\n      ];\r\n    } else {\r\n      // For defeated contracts\r\n      return [\r\n        { \r\n          label: \"1. Base Penalty:\", \r\n          value: `${(analysisData.basePenalty || 0).toFixed(1)} points` \r\n        },\r\n        { \r\n          label: \"2. Contract Level Penalties:\", \r\n          value: `${(analysisData.levelPenalties || 0).toFixed(1)} points` \r\n        },\r\n        { \r\n          label: \"3. Performance Bonus:\", \r\n          value: `${(analysisData.performanceBonus || 0).toFixed(1)} points` \r\n        },\r\n        { \r\n          label: \"4. Declarer Consolation:\", \r\n          value: `${(analysisData.consolationPoints || 0).toFixed(1)} points` \r\n        }\r\n      ];\r\n    }\r\n  };\r\n  \r\n  // Get final score for display\r\n  const finalScore = getFinalScore();\r\n  \r\n  // Get scores so far for display - including the current deal's scores\r\n  const getScoresSoFar = () => {\r\n    // Get the running totals from scores prop\r\n    const baseTotals = {\r\n      nsTotal: scores?.nsTotal || 0,\r\n      ewTotal: scores?.ewTotal || 0,\r\n      bonusNsTotal: scores?.bonusNsTotal || 0,\r\n      bonusEwTotal: scores?.bonusEwTotal || 0\r\n    };\r\n    \r\n    // Add the current deal's points to provide the most updated view\r\n    return {\r\n      nsTotal: baseTotals.nsTotal,\r\n      ewTotal: baseTotals.ewTotal,\r\n      bonusNsTotal: baseTotals.bonusNsTotal + (nsPoints || 0),\r\n      bonusEwTotal: baseTotals.bonusEwTotal + (ewPoints || 0)\r\n    };\r\n  };\r\n  \r\n  const scoresSoFar = getScoresSoFar();\r\n  \r\n  // Popup styles\r\n  const popupStyles = {\r\n    overlay: {\r\n      position: 'fixed',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      backgroundColor: 'rgba(0, 0, 0, 0.7)',\r\n      zIndex: 1000,\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      alignItems: 'center'\r\n    },\r\n    container: {\r\n      backgroundColor: '#fff',\r\n      borderRadius: '8px',\r\n      padding: '20px',\r\n      width: '80%',\r\n      maxWidth: '320px',\r\n      boxShadow: '0 4px 8px rgba(0, 0, 0, 0.2)'\r\n    },\r\n    title: {\r\n      fontSize: '18px',\r\n      fontWeight: 'bold',\r\n      marginBottom: '15px',\r\n      textAlign: 'center',\r\n      color: '#1e5c8b'\r\n    },\r\n    message: {\r\n      marginBottom: '15px',\r\n      lineHeight: '1.4',\r\n      textAlign: 'center',\r\n      fontSize: '15px'\r\n    },\r\n    buttonContainer: {\r\n      display: 'flex',\r\n      justifyContent: 'space-around'\r\n    },\r\n    button: {\r\n      padding: '8px 15px',\r\n      borderRadius: '5px',\r\n      border: 'none',\r\n      color: '#fff',\r\n      fontWeight: 'bold',\r\n      cursor: 'pointer',\r\n      fontSize: '14px'\r\n    },\r\n    cancelButton: {\r\n      backgroundColor: '#1e5c8b'\r\n    },\r\n    confirmButton: {\r\n      backgroundColor: '#3c8c5c'\r\n    }\r\n  };\r\n  \r\n  return (\r\n    <div className=\"final-score-analysis\">\r\n      <header className=\"analysis-header\">\r\n        <div className=\"title-container\">\r\n          <h1>Final Score Analysis - Deal #{currentDeal.dealNumber}</h1>\r\n          <p>Bonus Bridge Score Calculation</p>\r\n        </div>\r\n        <div className=\"header-buttons\">\r\n          <button className=\"scores-btn\" onClick={toggleScoresSoFar}>\r\n            Scores\r\n          </button>\r\n          <button className=\"info-btn\" onClick={handleShowExplanation}>\r\n            ?\r\n          </button>\r\n        </div>\r\n      </header>\r\n      \r\n      {/* Scores Popup */}\r\n      {showScoresSoFar && (\r\n        <div className=\"scores-popup\">\r\n          <div className=\"scores-popup-content\">\r\n            <h3>Scores So Far</h3>\r\n            <div className=\"scores-table\">\r\n              <div className=\"scores-header\">\r\n                <div className=\"team-col\">Team</div>\r\n                <div className=\"party-col\">Party Bridge</div>\r\n                <div className=\"bonus-col\">Bonus Bridge</div>\r\n              </div>\r\n              <div className=\"scores-row\">\r\n                <div className=\"team-col\">North-South</div>\r\n                <div className=\"party-col\">{scoresSoFar.nsTotal}</div>\r\n                <div className=\"bonus-col\">{scoresSoFar.bonusNsTotal}</div>\r\n              </div>\r\n              <div className=\"scores-row\">\r\n                <div className=\"team-col\">East-West</div>\r\n                <div className=\"party-col\">{scoresSoFar.ewTotal}</div>\r\n                <div className=\"bonus-col\">{scoresSoFar.bonusEwTotal}</div>\r\n              </div>\r\n            </div>\r\n            <button className=\"close-scores-btn\" onClick={toggleScoresSoFar}>Close</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Contract Category Banner */}\r\n      <div className=\"contract-category\">\r\n        <h2>{getContractCategory()}</h2>\r\n      </div>\r\n      \r\n      {/* Contract Details */}\r\n      <div className=\"contract-details\">\r\n        <p>Contract: {formatContract()} {madeContract ? 'Made' : 'Down'} {currentDeal.result !== 0 ? Math.abs(currentDeal.result) : 'exactly'}</p>\r\n        <p>Raw score: {currentDeal.rawScore} points</p>\r\n      </div>\r\n      \r\n      {/* Tab Navigation */}\r\n      <div className=\"analysis-tabs\">\r\n        <button \r\n          className={`tab-btn ${activeTab === 'summary' ? 'active' : ''}`}\r\n          onClick={() => handleTabChange('summary')}\r\n        >\r\n          Summary\r\n        </button>\r\n        <button \r\n          className={`tab-btn ${activeTab === 'hand' ? 'active' : ''}`}\r\n          onClick={() => handleTabChange('hand')}\r\n        >\r\n          Hand Analysis\r\n        </button>\r\n        <button \r\n          className={`tab-btn ${activeTab === 'calculation' ? 'active' : ''}`}\r\n          onClick={() => handleTabChange('calculation')}\r\n        >\r\n          Calculation\r\n        </button>\r\n      </div>\r\n      \r\n      {/* Tab Content */}\r\n      <div className=\"tab-content\">\r\n        {/* Summary Tab */}\r\n        {activeTab === 'summary' && (\r\n          <div className=\"summary-tab\">\r\n            <div className=\"final-scores\">\r\n              <h3>Final Bonus Bridge Score</h3>\r\n              <div className=\"score-box\">\r\n                {/* For defeated contracts, show defender first since they get the points */}\r\n                {!madeContract ? (\r\n                  <>\r\n                    <div className=\"score-row\">\r\n                      <span className=\"score-label\">{finalScore.defenderTeam} (Defender):</span>\r\n                      <span className=\"score-value\">{finalScore.defenderPoints} points</span>\r\n                    </div>\r\n                    <div className=\"score-row\">\r\n                      <span className=\"score-label\">{finalScore.declarerTeam} (Declarer):</span>\r\n                      <span className=\"score-value\">{finalScore.declarerPoints} points</span>\r\n                    </div>\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <div className=\"score-row\">\r\n                      <span className=\"score-label\">{finalScore.declarerTeam} (Declarer):</span>\r\n                      <span className=\"score-value\">{finalScore.declarerPoints} points</span>\r\n                    </div>\r\n                    <div className=\"score-row\">\r\n                      <span className=\"score-label\">{finalScore.defenderTeam} (Defender):</span>\r\n                      <span className=\"score-value\">{finalScore.defenderPoints} points</span>\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </div>\r\n              \r\n              <p className=\"score-explanation\">\r\n                {madeContract ? \r\n                  `The contract was made${currentDeal.result > 0 ? ' with ' + currentDeal.result + ' overtrick' + (currentDeal.result > 1 ? 's' : '') : ' exactly'}.` :\r\n                  `The contract was defeated by ${Math.abs(currentDeal.result)} trick${Math.abs(currentDeal.result) > 1 ? 's' : ''}.`\r\n                }\r\n              </p>\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {/* Hand Analysis Tab */}\r\n        {activeTab === 'hand' && (\r\n          <div className=\"hand-tab\">\r\n            <h3>Hand Analysis</h3>\r\n            <div className=\"analysis-details\">\r\n              <div className=\"detail-row\">\r\n                <span className=\"detail-label\">Combined HCP (Declarer + Dummy):</span>\r\n                <span className=\"detail-value\">{totalHCP}</span>\r\n              </div>\r\n              <div className=\"detail-row\">\r\n                <span className=\"detail-label\">Declarer HCP Percentage:</span>\r\n                <span className=\"detail-value\">{declarerHCPPercentage}%</span>\r\n              </div>\r\n              <div className=\"detail-row\">\r\n                <span className=\"detail-label\">Defender HCP Percentage:</span>\r\n                <span className=\"detail-value\">{defenderHCPPercentage}%</span>\r\n              </div>\r\n              <div className=\"detail-row\">\r\n                <span className=\"detail-label\">HCP Advantage:</span>\r\n                <span className=\"detail-value\">{hcpAdvantage}% to {advantageSide}</span>\r\n              </div>\r\n              <div className=\"detail-row\">\r\n                <span className=\"detail-label\">Number of Singletons:</span>\r\n                <span className=\"detail-value\">{singletons}</span>\r\n              </div>\r\n              <div className=\"detail-row\">\r\n                <span className=\"detail-label\">Number of Voids:</span>\r\n                <span className=\"detail-value\">{voids}</span>\r\n              </div>\r\n              <div className=\"detail-row\">\r\n                <span className=\"detail-label\">Number of Long Suits (6+ cards):</span>\r\n                <span className=\"detail-value\">{longSuits}</span>\r\n              </div>\r\n              <div className=\"detail-row\">\r\n                <span className=\"detail-label\">Distribution Points:</span>\r\n                <span className=\"detail-value\">{distributionPoints}</span>\r\n              </div>\r\n              <div className=\"detail-row\">\r\n                <span className=\"detail-label\">Expected HCP for Contract:</span>\r\n                <span className=\"detail-value\">{expectedHCP}</span>\r\n              </div>\r\n              <div className=\"detail-row\">\r\n                <span className=\"detail-label\">Contract Expected Tricks:</span>\r\n                <span className=\"detail-value\">{contractExpectedTricks}</span>\r\n              </div>\r\n              <div className=\"detail-row\">\r\n                <span className=\"detail-label\">Hand Expected Tricks:</span>\r\n                <span className=\"detail-value\">{handExpectedTricks}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {/* Calculation Tab */}\r\n        {activeTab === 'calculation' && (\r\n          <div className=\"calculation-tab\">\r\n            <h3>Calculation Steps ({madeContract ? 'Made Contract' : 'Defeated Contract'})</h3>\r\n            \r\n            <div className=\"calculation-steps\">\r\n              {getCalculationSteps().map((step, index) => (\r\n                <div className=\"calc-step\" key={index}>\r\n                  <span className=\"step-label\">{step.label}</span>\r\n                  <span className=\"step-value\">{step.value}</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n            \r\n            <div className=\"final-calculation\">\r\n              <h3>Final Result</h3>\r\n              {!madeContract ? (\r\n                <>\r\n                  <div className=\"calc-step\">\r\n                    <span className=\"step-label\">{finalScore.defenderTeam} Points:</span>\r\n                    <span className=\"step-value\">{finalScore.defenderPoints}</span>\r\n                  </div>\r\n                  <div className=\"calc-step\">\r\n                    <span className=\"step-label\">{finalScore.declarerTeam} Points:</span>\r\n                    <span className=\"step-value\">{finalScore.declarerPoints}</span>\r\n                  </div>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <div className=\"calc-step\">\r\n                    <span className=\"step-label\">{finalScore.declarerTeam} Points:</span>\r\n                    <span className=\"step-value\">{finalScore.declarerPoints}</span>\r\n                  </div>\r\n                  <div className=\"calc-step\">\r\n                    <span className=\"step-label\">{finalScore.defenderTeam} Points:</span>\r\n                    <span className=\"step-value\">{finalScore.defenderPoints}</span>\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n      {/* UPDATED: Optimized button layout - Two equal buttons side by side */}\r\n      <div className=\"main-action-buttons\">\r\n        <button className=\"edit-analysis-btn\" onClick={onEdit}>\r\n          Edit Analysis\r\n        </button>\r\n        \r\n        <button className=\"save-continue-btn\" onClick={handleSave}>\r\n          Save & Continue\r\n        </button>\r\n      </div>\r\n      \r\n      {/* End Game button in a separate row */}\r\n      <div className=\"end-game-row\">\r\n        <button className=\"end-game-btn\" onClick={handleShowEndGameConfirm}>\r\n          End Game & View Results\r\n        </button>\r\n      </div>\r\n      \r\n      {/* Explanation popup when shown */}\r\n      {showExplanation && (\r\n        <BonusBridgeExplanation onClose={handleHideExplanation} />\r\n      )}\r\n      \r\n      {/* End Game Confirmation Popup */}\r\n      {showEndGameConfirm && (\r\n        <div style={popupStyles.overlay}>\r\n          <div style={popupStyles.container}>\r\n            <h2 style={popupStyles.title}>End Current Game?</h2>\r\n            <p style={popupStyles.message}>\r\n              Are you sure you want to end the current game? This will save the current deal and show the final game results.\r\n            </p>\r\n            <div style={popupStyles.buttonContainer}>\r\n              <button \r\n                style={{...popupStyles.button, ...popupStyles.cancelButton}}\r\n                onClick={handleHideEndGameConfirm}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button \r\n                style={{...popupStyles.button, ...popupStyles.confirmButton}}\r\n                onClick={handleEndGame}\r\n              >\r\n                End Game\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FinalScoreAnalysis;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}